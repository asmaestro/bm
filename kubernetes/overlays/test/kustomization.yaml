---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: test

resources:
  - ../../base
  - flight-hpa.yaml
  - ingress.yaml

patches:
- target:
    kind: Deployment
    labelSelector: app.kubernetes.io/part-of=booking-microservices
  patch: |-
    - op: add
      path: /spec/progressDeadlineSeconds
      value: 60
# While using HPA, it is recommended to remove `spec.replicas`: https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/#migrating-deployments-and-statefulsets-to-horizontal-autoscaling
- target:
    kind: Deployment
    name: flight-deployment
  patch: |
    - op: remove
      path: /spec/replicas

